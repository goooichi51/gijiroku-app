import SwiftUI

struct PrivacyPolicyView: View {
    var body: some View {
        ScrollView {
            VStack(alignment: .leading, spacing: 16) {
                Text("最終更新日: 2026年2月20日")
                    .font(.caption)
                    .foregroundColor(.secondary)

                section("1. 運営者情報",
                        "本アプリは個人開発者により運営されています。お問い合わせは本ポリシー末尾の連絡先までお願いいたします。")

                section("2. 収集する情報", nil)

                subsection("2.1 アカウント情報",
                           """
                           本アプリのご利用にはアカウント登録が必要です。以下の情報を収集します。

                           ・Apple IDに関連付けられた識別子（Sign in with Apple利用時）
                           ・メールアドレス（メール認証利用時）
                           """)

                subsection("2.2 音声データ",
                           """
                           音声データは端末内でのみ処理され、サーバーに送信されることはありません。

                           ・録音した音声ファイルはお使いの端末内にのみ保存されます
                           ・文字起こし処理はApple SpeechAnalyzerにより端末内で完結します
                           ・音声データがインターネットを通じて外部に送信されることはありません
                           """)

                subsection("2.3 文字起こし・要約データ",
                           """
                           ・文字起こしテキストおよびAI要約結果は、お使いの端末内にのみ保存されます
                           ・AI要約機能をご利用の際、文字起こしテキストのみがサーバーに送信され、AI処理後に結果が返されます。サーバー側でのテキストデータの永続的な保存は行いません
                           """)

                subsection("2.4 会議メタデータ",
                           """
                           以下の会議メタデータはクラウド同期のためサーバーに保存されます。

                           ・会議タイトル、日時、場所
                           ・参加者名
                           ・使用テンプレート種別
                           ・録音時間
                           """)

                subsection("2.5 課金情報",
                           "サブスクリプションの課金処理はAppleのApp Store決済システムを通じて行われます。クレジットカード番号等の決済情報を本アプリが直接収集・保管することはありません。")

                section("3. 情報の利用目的",
                        """
                        収集した情報は以下の目的で利用します。

                        ・アカウントの認証・管理
                        ・AI要約機能の提供（文字起こしテキストの一時的な送信）
                        ・会議データの端末間同期
                        ・サブスクリプションの管理
                        ・アプリの改善・不具合対応
                        """)

                section("4. 第三者への提供",
                        """
                        本アプリでは以下のサービスを利用しています。

                        ・Supabase（Supabase Inc.）: 認証・データ同期。アカウント情報と会議メタデータが送信されます
                        ・Google Gemini API（Google LLC）: AI要約処理。文字起こしテキストが一時的に送信されます
                        ・Apple SpeechAnalyzer（Apple Inc.）: 音声文字起こし。端末内処理のため外部送信なし

                        上記以外の第三者に個人情報を提供することはありません。ただし、法令に基づく開示請求があった場合はこの限りではありません。
                        """)

                section("5. データの保管と削除",
                        """
                        ・音声データ、文字起こしテキスト、AI要約結果はお使いの端末内にのみ保存されます
                        ・アプリを削除すると、端末内のすべてのデータが削除されます
                        ・サーバーに保存された会議メタデータは、アカウント削除時に削除されます
                        ・アカウント削除をご希望の場合は、設定画面の「アカウント削除」またはサポート連絡先までご連絡ください
                        """)

                section("6. セキュリティ",
                        """
                        お客様の情報を保護するために以下の対策を講じています。

                        ・サーバーとの通信はすべてHTTPS（TLS）により暗号化
                        ・データベースへのアクセスはRow Level Security（RLS）により制御
                        ・APIキーはアプリに直接埋め込まず、サーバーサイドで安全に管理
                        """)

                section("7. お子様のプライバシー",
                        "本アプリは4歳以上を対象としていますが、13歳未満のお子様から意図的に個人情報を収集することはありません。")

                section("8. プライバシーポリシーの変更",
                        "本ポリシーは必要に応じて変更することがあります。重要な変更がある場合は、アプリ内通知またはアプリのアップデート時にお知らせします。")

                section("9. お問い合わせ",
                        "プライバシーに関するお問い合わせは以下までご連絡ください。\n\nメール: gijiroku.app.sup@gmail.com")
            }
            .padding()
        }
        .navigationTitle("プライバシーポリシー")
        .navigationBarTitleDisplayMode(.inline)
    }

    private func section(_ title: String, _ body: String?) -> some View {
        VStack(alignment: .leading, spacing: 8) {
            Text(title)
                .font(.headline)
            if let body {
                Text(body)
                    .font(.subheadline)
                    .foregroundColor(.secondary)
            }
        }
    }

    private func subsection(_ title: String, _ body: String) -> some View {
        VStack(alignment: .leading, spacing: 6) {
            Text(title)
                .font(.subheadline)
                .fontWeight(.semibold)
            Text(body)
                .font(.subheadline)
                .foregroundColor(.secondary)
        }
        .padding(.leading, 8)
    }
}

struct TermsOfServiceView: View {
    var body: some View {
        ScrollView {
            VStack(alignment: .leading, spacing: 16) {
                Text("最終更新日: 2026年2月20日")
                    .font(.caption)
                    .foregroundColor(.secondary)

                Text("本利用規約（以下「本規約」）は、「議事録アプリ - AI文字起こし&要約」（以下「本アプリ」）の利用条件を定めるものです。本アプリをご利用いただくことで、本規約に同意したものとみなします。")
                    .font(.subheadline)
                    .foregroundColor(.secondary)

                section("第1条（適用）",
                        "本規約は、本アプリの利用に関する一切の関係に適用されます。")

                section("第2条（アカウント）",
                        """
                        1. 本アプリの利用にはアカウント登録が必要です。
                        2. ユーザーはApple IDまたはメールアドレスによりアカウントを作成できます。
                        3. アカウント情報の管理責任はユーザーにあります。第三者による不正利用について、運営者は一切の責任を負いません。
                        """)

                section("第3条（料金プラン・サブスクリプション）",
                        """
                        1. 本アプリは無料プラン（Free）と有料プラン（Standard: 月額490円）を提供します。
                        2. 有料プランの課金はApple IDを通じてApp Store決済で行われます。
                        3. サブスクリプションは現在の期間終了日の少なくとも24時間前までにキャンセルされない限り、自動的に更新されます。
                        4. サブスクリプションの管理・解約は、iPhoneの「設定」→ Apple ID →「サブスクリプション」から行えます。
                        5. 返金については、Appleのポリシーに準じます。
                        """)

                section("第4条（無料プランの制限）",
                        """
                        Freeプランには以下の制限があります。
                        ・月間録音回数: 5回まで
                        ・1回あたりの録音時間: 30分まで
                        ・AI議事録生成: 利用不可
                        ・PDF出力: 利用不可
                        """)

                section("第5条（禁止事項）",
                        """
                        ユーザーは以下の行為を行ってはなりません。
                        1. 法令または公序良俗に違反する行為
                        2. 他者のプライバシーを侵害する目的での録音
                        3. 録音が法律で禁止されている状況での本アプリの使用
                        4. 本アプリの逆コンパイル、リバースエンジニアリング、改ざん
                        5. 本アプリのサーバーに対する不正アクセスや過度な負荷をかける行為
                        """)

                section("第6条（録音に関する注意事項）",
                        """
                        1. 会議の録音にあたっては、参加者の同意を得ることを強く推奨します。
                        2. 録音の合法性はご利用の地域の法律に従います。ユーザーの責任において適用法令を遵守してください。
                        3. 本アプリは録音データの正確性・完全性を保証するものではありません。
                        """)

                section("第7条（AI機能に関する免責）",
                        """
                        1. AI文字起こしおよびAI要約の結果は参考情報であり、正確性・完全性を保証するものではありません。
                        2. 重要な議事録については、AI生成結果をユーザー自身で確認・修正してからご利用ください。
                        3. AI機能の品質は、録音環境・音声品質・発話の明瞭さ等により変動します。
                        """)

                section("第8条（知的財産権）",
                        """
                        1. 本アプリに関する知的財産権は運営者に帰属します。
                        2. ユーザーが本アプリを利用して作成した議事録等のコンテンツの権利は、ユーザーに帰属します。
                        """)

                section("第9条（サービスの変更・終了）",
                        """
                        1. 運営者は、ユーザーに通知することなく本アプリの内容を変更し、または提供を終了することがあります。
                        2. サービス終了の際は、可能な限り事前にユーザーへ通知いたします。
                        """)

                section("第10条（免責事項）",
                        """
                        1. 運営者は、本アプリの利用により生じた損害について一切の責任を負いません。
                        2. 端末の故障・紛失等によるデータの消失について、運営者は責任を負いません。重要なデータはユーザー自身でバックアップしてください。
                        3. ネットワーク障害、サーバー障害等により一時的にサービスが利用できない場合があります。
                        """)

                section("第11条（規約の変更）",
                        "運営者は必要に応じて本規約を変更できるものとします。変更後の規約は、アプリ内またはアプリのアップデートを通じてユーザーに通知します。変更後も本アプリを継続利用された場合、変更後の規約に同意したものとみなします。")

                section("第12条（準拠法・管轄）",
                        """
                        1. 本規約は日本法に準拠します。
                        2. 本アプリに関する紛争については、東京地方裁判所を第一審の専属的合意管轄裁判所とします。
                        """)

                section("お問い合わせ",
                        "本規約に関するお問い合わせは以下までご連絡ください。\n\nメール: gijiroku.app.sup@gmail.com")
            }
            .padding()
        }
        .navigationTitle("利用規約")
        .navigationBarTitleDisplayMode(.inline)
    }

    private func section(_ title: String, _ body: String) -> some View {
        VStack(alignment: .leading, spacing: 8) {
            Text(title)
                .font(.headline)
            Text(body)
                .font(.subheadline)
                .foregroundColor(.secondary)
        }
    }
}
